/** 
 *  (c) LudvÃ­k Prokopec
 *  License: MIT 
 */
!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"===("undefined"==typeof exports?"undefined":n(exports))&&"undefined"!=typeof module?module.exports=t(n):"function"==typeof define&&define.amd?define(function(){return t(n)}):(e=e||self).ReactiveHTML=t(n)}(void 0,function(i){"use strict";function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function u(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function p(e){return Array.isArray(e)}function s(e){return"object"===i(e)&&null!==e}function a(e){return"function"==typeof e}function l(e){return!(!a(e)||!e.prototype.isReactiveHTMLComponent)}var d=0,o=1,c=[];function y(e,t,n){e&&(void 0!==n?c.includes(n)||(c.push(n),console.warn(t)):console.warn(t))}function v(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=null;null!==t&&void 0!==t._key&&(n=t._key,Reflect.deleteProperty(t,"_key")),t=t||{};for(var r=arguments.length,o=new Array(2<r?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(l(e))return o.length&&(t=u({children:o},t)),{type:e,props:t,_key:n};if(a(e)||!("string"==typeof e||e instanceof String))throw TypeError("createElement(...) type can be only Component or String as tag of Element");return{type:e,attrs:t,children:o,_key:n}}function e(e){return this.props=e,this.states={},this.ref={realDOM:null,virtual:null},this}function h(e,t,n){if(!e.ref.realDOM)throw Error("setState(...) can be called only if component is rendered, will be mounted or is mounted");if(s(t)||a(t)){if(y(!s(t=a(t)?t.bind(e)(e.props,e.states):t)||0===Object.keys(t).length,"setState(...) should be Object or Function that returns Object, if Object is empty or doesn't return nothing, update can be redundant",o),n)return g(e,null,t),e;var r=j(e,null,t);return r&&(r=(n=f(r,2))[0],n=n[1],r=f(r(e.ref.realDOM),2),e.ref.virtual=r[0],e.ref.realDOM=r[1],e.onComponentUpdate(n)),e}throw TypeError("setState(...) expecting 1 parameter as Function or Object, you give ".concat(i(t)))}function m(e){if(null==e)throw TypeError("Element cannot return nothing or null");return e}function b(e){var t=new e.type(e.props);return t.ref.virtual=m(t.Element()),t._key=e._key,t.type=e.type,t}function g(e,t,n){return s(t)&&Object.assign(e.props,t),s(n)&&Object.assign(e.states,n),e}function O(e,t){e.onComponentMount(e.ref.realDOM,t)}function C(e){e.onComponentRender(e.ref.realDOM)}function M(e,t){e.onComponentWillMount(e.ref.realDOM,t)}function w(t){if(s(t))if(l(t.type))t.onComponentWillUnMount(t.ref.realDOM),t.setState=function(){t.setState=function(){};var e=t.constructor.name;if(!alreadyThrowedError.includes(e))throw alreadyThrowedError.push(e),Error("Remove all asynchronnous functions that causes setState(...) of ".concat(e," in onComponentWillUnMount, else it causes memory leak"))},w(t.ref.virtual);else for(var e=0;e<t.children.length;e++)w(t.children[e])}function j(e,t,n){if(!0!==e.shouldComponentUpdate(t,n))return(e=g(e,t,n)).onComponentCancelUpdate(),!1;var r=e.getSnapshotBeforeUpdate()||null;(e=g(e,t,n)).onComponentWillUpdate(r);n=m(e.Element());return[D(e.ref.virtual,n),r]}function n(e){var t,n=document.createElement(e.type);for(t in e.attrs)t.startsWith("on")?n.addEventListener(t.replace("on",""),e.attrs[t]):s(e.attrs[t])?Object.assign(n[t],e.attrs[t]):n[t]=e.attrs[t];if(e.children.length){for(var r=document.createDocumentFragment(),o=0,i=e.children;o<i.length;o++){var u=E(i[o]);S(u,r,"appendChild"),u&&(i[o]=p(u=u)?u.map(function(e){return e.virtual}):u.virtual)}n.appendChild(r)}return n}function S(e,t,n){for(var r=arguments.length,o=new Array(3<r?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];if(void 0!==e){if(p(e))return e.map(function(e){return S.apply(void 0,[e,t,n].concat(o))});var u=l(e.virtual.type);return void 0!==e.ref.realDOM&&(u&&M(e.virtual,t),t[n].apply(t,[e.ref.realDOM].concat(o)),u&&O(e.virtual,t)),e.ref.realDOM}}function E(e){if(void 0!==e){if(p(e))return e.map(E);if(!s(e))return{ref:{realDOM:document.createTextNode(e)},virtual:e};if(l(e.type)){var t=E((e=b(e)).ref.virtual);return e.ref.realDOM=t.ref.realDOM,e.ref.virtual=t.virtual,C(e),{ref:{realDOM:e.ref.realDOM},virtual:e}}return{ref:{realDOM:n(e)},virtual:e}}}function D(n,r){var e=s(n),t=s(r),o=e&&l(n.type),i=t&&l(r.type);return void 0===r?function(e){return w(n),e.remove(),[void 0,void 0]}:o||i?function(r,o,e,t){if(e&&t)return r.type===o.type?function(e){r.setState=function(e){return h(this,e,!0)},r.componentWillReceiveProps(o.props),r.setState=function(e){return h(this,e,!1)};var t,n=j(r,o.props,null);return n&&(n=(t=f(n,2))[0],t=t[1],n=f(n(e),2),r.ref.virtual=n[0],r.ref.realDOM=n[1],r.onComponentUpdate(t)),[r,e]}:function(e){var t=b(o);w(r);var n=f(D(r.ref.virtual,t.ref.virtual)(e),2);return t.ref.virtual=n[0],t.ref.realDOM=n[1],C(t),M(t,e.parentNode),O(t,e.parentNode),[t,e]};return!e||t?function(e){var t=b(o),n=f(D(r,t.ref.virtual)(e),2);return t.ref.virtual=n[0],t.ref.realDOM=n[1],C(t),M(t,e.parentNode),O(t,e.parentNode),[t,e]}:function(e){var t=f(D(r.ref.virtual,o)(e),2);return o=t[0],e=t[1],w(r),[o,e]}}(n,r,o,i):e&&t?n.type!==r.type?function(e){var t=E(r),e=S(t,e,"replaceWith");return[t.virtual,e]}:function(e){return n._memo?[n,e]:((s(n.attrs)||s(r.attrs))&&(t=f(function(n,r){var e,o=[];for(e in r)!function(t){t.startsWith("on")?t in n||o.push(function(e){return e.addEventListener(t.replace("on",""),r[t]),e}):s(r[t])?o.push(function(e){return Object.assign(e[t],r[t]),e}):r[t]===n[t]&&t in n||o.push(function(e){return e[t]=r[t],e})}(e);for(var t in n)!function(t){t in r||(t.startsWith("on")?o.push(function(e){return e.removeEventListener(t.replace("on",""),n[t]),e}):o.push(function(e){return e.removeAttribute(t),e}))}(t);return function(e){for(var t=0;t<o.length;t++)e=o[t](e);return[r,e]}}(n.attrs||{},r.attrs||{})(e),2),r.attrs=t[0],e=t[1]),0<n.children.length+r.children.length&&(t=function t(o,i,n){var u=[];var a=[];var e=function(r,e){p(o[r])?a.push(t(o[r],i[r],!0)):s(o[r])&&null!==o[r]._key?u.push(function(e){var t=i.find(function(e){return e._key===o[r]._key}),n=i.indexOf(t),t=D(o[r],t)(e),t=f(t,2);return i[n]=t[0],e=t[1],[i[n],e]}):(y(n,"Children inside array should be keyed by _key attribute/prop, if you don't key your elements, it can cause redundant rerender or bad rerender",d),u.push(function(e){var t=D(o[r],i[r])(e),t=f(t,2);return i[r]=t[0],e=t[1],[i[r],e]}))};for(var r=0,l=o.length;r<l;r++)e(r,l);function c(r,t){if(r.length>t.length)for(var e=function(n,e){p(r[n])?c(r[n],t[n]||[]):null!==r[n]._key?t.some(function(e){return e._key===r[n]._key})||a.push(function(e){var t=E(r[n]);return r[n]=t.virtual,o=(n===r.length-1?S(t,e,"appendChild"):S(t,e,"insertBefore",e.childNodes[n]),n),[r,e]}):(n+=t.length,a.push(function(e){var t=E(r[n]);return r[n]=t.virtual,S(t,e,"appendChild"),o=n,[r,e]})),o=n},o=0,n=r.length;o<n;o++)e(o,n)}c(i,o);return function(e){k(u,e.childNodes).forEach(function(e){var t=f(e,2),e=t[0],t=t[1];e(t)});for(var t=0;t<a.length;t++)a[t](e);return[i,e]}}(n.children,r.children)(e),t=f(t,2),r.children=t[0],e=t[1]),[r,e]);var t}:function(t,n,e,r){if(e||r)return function(e){var t=E(n),e=S(t,e,"replaceWith");return[t.virtual,e]};return t!==n?function(e){return[e.nodeValue=n,e]}:function(e){return[t,e]}}(n,r,e,t)}function k(e,t){for(var n=[],r=0;r<Math.min(e.length,t.length);r++)n.push([e[r],t[r]]);return n}return e.prototype.Element=function(){throw Error("You have to specify Element method in your Component, Element must return virtual element")},e.prototype.setState=function(e){return h(this,e,!1)},e.prototype.onComponentRender=e.prototype.onComponentWillUpdate=e.prototype.onComponentUpdate=e.prototype.onComponentWillMount=e.prototype.onComponentMount=e.prototype.onComponentCancelUpdate=e.prototype.getSnapshotBeforeUpdate=e.prototype.componentWillReceiveProps=e.prototype.onComponentWillUnMount=function(){},e.prototype.shouldComponentUpdate=function(){return!0},e.prototype.isReactiveHTMLComponent=!0,{Component:e,render:function(e,t){void 0!==(e=E(e))&&S(e,t,"appendChild")},createElement:v,createFactory:function(o){if(l(o))throw TypeError("createFactory(...) expecting first parameter as component Class, you give ".concat(i(o)));return function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return v.apply(void 0,[o,e].concat(n))}},memo:function(e){return y(l(e.type),"Memoizing Component will not affect Component from rerender, Component has lifecycle shouldComponentUpdate(nextProps, nextStates), which is used to decide if Component will udpate or not"),e._memo=!0,e}}});
