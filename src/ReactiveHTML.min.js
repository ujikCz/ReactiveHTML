/** 
 *  (c) LudvÃ­k Prokopec
 *  License: MIT 
 */
(function(a,b){function c(a){"@babel/helpers - typeof";return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c(a)}"object"===("undefined"==typeof exports?"undefined":c(exports))&&"undefined"!=typeof module?module.exports=b(c):"function"==typeof define&&define.amd?define(function(){return b(c)}):(a=a||self,a.ReactiveHTML=b(c))})(void 0,function(a){"use strict";function b(a,b){return g(a)||f(a,b)||d(a,b)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(a,b){if(a){if("string"==typeof a)return e(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?e(a,b):void 0}}function e(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function f(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function g(a){if(Array.isArray(a))return a}function h(a){return a._memo=!0,a}function j(b){return"object"===a(b)&&null!==b}function k(a){return"function"==typeof a}function l(a){return!!(k(a)&&a.prototype.isReactiveHTMLComponent)}function m(a){return Array.isArray(a)}function n(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,c=null;if(null!==b&&void 0!==b._key&&(c=b._key,Reflect.deleteProperty(b,"_key")),l(a))return{type:a,props:b,_key:c};for(var d=arguments.length,e=Array(2<d?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return{type:a,attrs:b,children:e,_key:c}}function o(a,b,c){return j(b)&&(a.props?Object.assign(a.props,b):a.props=b),j(c)&&(a.states?Object.assign(a.states,c):a.states=c),a}function p(a){return this.props=a||{},this.ref={},this}function q(a,b){a.vnode===void 0?a.onComponentUnMount():a.onComponentUpdate(a.ref.realDOM,b)}function r(a,b,c){b===void 0?(a.onComponentWillUnMount(a.ref.realDOM),a.ref.parent=a.ref.realDOM.parentNode):a.onComponentWillUpdate(a.ref.realDOM,c)}function s(a){var b=new a.type(a.props);return b.vnode=b.Element(),b.type=a.type,b._key=a._key,b}function t(a){return m(a)?a.map(function(a){return t(a)}):j(a)&&l(a.type)?(a=s(a),a.vnode=t(a.vnode),a.onComponentWillRender(),a):a}function u(a,b,c){if(a._memo)return a.onComponentCancelUpdate({cancelType:h}),function(){return[a.vnode,a.ref.realDOM]};if(!1===a.shouldComponentUpdate(b.props,c))return a=o(a,b.props,c),a.onComponentCancelUpdate({cancelType:a.onComponentCancelUpdate}),function(){return[a.vnode,a.ref.realDOM]};var d=null;a.getSnapshotBeforeUpdate&&(d=a.getSnapshotBeforeUpdate(a.props,a.states)||null),a=o(a,b.props,c);var e=a.Element();return r(a,e,d),[y(a.vnode,e),d]}function v(a){return j(a)?l(a.type)?(a.ref.realDOM=v(a.vnode),a.onComponentRender(a.ref.realDOM),a.ref.realDOM):x(a):document.createTextNode(a)}function w(a,b,c){var d=v(a),e=j(a)&&l(a.type);e&&a.onComponentWillMount(d);for(var f=arguments.length,g=Array(3<f?f-3:0),h=3;h<f;h++)g[h-3]=arguments[h];return b[c].apply(b,[d].concat(g)),e&&a.onComponentMount(d),d}function x(a){var b=document.createElement(a.type);for(var c in a.attrs)if(c.startsWith("on")){b.addEventListener(c.replace("on",""),a.attrs[c]);continue}else if(j(a.attrs[c])){Object.assign(b[c],a.attrs[c]);continue}else b[c]=a.attrs[c];if(a.children.length)for(var d,e=0,f=a.children;e<f.length;e++)if(d=t(f[e]),m(d)){for(var g,h=0;h<d.length;h++)g=t(d[h]),d[h]=g,w(g,b,"appendChild");a.children[e]=d}else a.children[e]=d,w(d,b,"appendChild");return b}function y(a,c){var d=j(a),e=j(c),f=!!d&&l(a.type),g=!!e&&l(c.type);return void 0===c?function(a){return a.remove(),[void 0,void 0]}:f&&g?a.type===c.type?function(d){var e=u(a,c),f=b(e,2),g=f[0],h=f[1],i=g(d),j=b(i,2);return a.vnode=j[0],d=j[1],q(a,h),[a,d]}:function(d){a.onComponentWillUnMount(a.ref.realDOM);var e=s(c),f=y(a.vnode,e.vnode)(d),g=b(f,2);return e.vnode=g[0],d=g[1],e.onComponentRender(d),e.onComponentWillMount(d),e.ref.realDOM=d,a.ref.parent=a.ref.realDOM.parentNode,a.ref.realDOM=void 0,a.onComponentUnMount(),e.onComponentMount(d),[e,d]}:f&&!g?function(d){var e=y(a.vnode,c);a.onComponentWillUnMount(a.ref.realDOM);var f=e(d),g=b(f,2);return c=g[0],d=g[1],a.ref.parent=a.ref.realDOM.parentNode,a.ref.realDOM=void 0,a.onComponentUnMount(),[c,d]}:!f&&g?function(d){var e=s(c),f=y(a,e.vnode),g=f(d),h=b(g,2);return c=h[0],d=h[1],e.onComponentWillRender(),e.ref.realDOM=d,e.onComponentRender(d),e.onComponentWillMount(d),e.onComponentMount(d),[c,d]}:d||e?!d&&e||d&&!e?function(a){var b=t(c),d=w(b,a,"replaceWith");return[b,d]}:a.type===c.type?function(d){if(a._memo)return[a,d];if(j(a.attrs)||j(c.attrs)){var e=z(a.attrs||{},c.attrs||{})(d),f=b(e,2);c.attrs=f[0],d=f[1]}if(0<a.children.length+c.children.length){var g=A(a.children,c.children)(d),h=b(g,2);c.children=h[0],d=h[1]}return[c,d]}:function(a){var b=t(c),d=w(b,a,"replaceWith");return[b,d]}:a===c?function(b){return[a,b]}:function(a){return a.nodeValue=c,[c,a]}}function z(a,b){var c=[],d=function(d){d.startsWith("on")?!(d in a)&&c.push(function(a){return a.addEventListener(d.replace("on",""),b[d]),a}):j(b[d])?c.push(function(a){return Object.assign(a[d],b[d]),a}):(b[d]!==a[d]||!(d in a))&&c.push(function(a){return a[d]=b[d],a})};for(var e in b)d(e);var f=function(d){d in b||(d.startsWith("on")?c.push(function(b){return b.removeEventListener(d.replace("on",""),a[d]),console.log(b),b}):c.push(function(a){return a.removeAttribute(d),a}))};for(var g in a)f(g);return function(a){for(var d=0;d<c.length;d++)a=c[d](a);return[b,a]}}function A(a,c){for(var d=[],e=[],f=function(g){m(a[g])?e.push(A(a[g],c[g])):j(a[g])&&null!==a[g]._key?d.push(function(d){var e=c.find(function(b){return b._key===a[g]._key}),f=c.indexOf(e),h=y(a[g],e)(d),i=b(h,2);return c[f]=i[0],d=i[1],[c[f],d]}):d.push(function(d){var e=y(a[g],c[g])(d),f=b(e,2);return c[g]=f[0],d=f[1],[c[g],d]})},g=0,h=a.length;g<h;g++)f(g,h);if(c.length>a.length)for(var k=function(b){m(c[b])||(null===c[b]._key?(b=a.length,e.push(function(a){var d=t(c[b]);return c[b]=d,w(d,a,"appendChild"),l=b,[d,a]})):!a.some(function(a){return a._key===c[b]._key})&&e.push(function(a){var d=t(c[b]);return(c[b]=d,b===c.length-1)?(w(d,a,"appendChild"),l=b,[d,a]):(w(d,a,"insertBefore",a.childNodes[b]),l=b,[d,a])})),l=b},l=0,n=c.length;l<n;l++)k(l,n);return function(a){B(d,a.childNodes).forEach(function(a){var c=b(a,2),d=c[0],e=c[1];d(e)});for(var f=0;f<e.length;f++)e[f](a);return[c,a]}}function B(a,b){for(var c=[],d=0;d<Math.min(a.length,b.length);d++)c.push([a[d],b[d]]);return c}p.prototype.Element=function(){throw Error("You have to specify Element method in your Component, if you want to return any element, return ".concat(void 0))},p.prototype.setState=function(c){function d(a,c){if(a.ref.realDOM){var d=u(a,a,c),e=b(d,2),f=e[0],g=e[1],h=f(a.ref.realDOM),i=b(h,2);a.vnode=i[0],a.ref.realDOM=i[1],q(a,g)}else if(a.ref.parent){o(a,a,c),a.onComponentWillRender();var j=a.Element(),k=v(j);a.vnode=j,a.ref.realDOM=k,a.onComponentRender(k),a.onComponentWillMount(k),a.ref.parent.appendChild(k),a.onComponentMount(k),a.ref.parent=void 0}return a}if(k(c)){var e=c.bind(this)();return d(this,e)}if(j(c))return d(this,c);throw TypeError("setState method expecting 1 parameter as Function or Object, you give ".concat(a(c)))},p.prototype.onComponentUpdate=p.prototype.onComponentWillUpdate=p.prototype.onComponentRender=p.prototype.onComponentWillRender=p.prototype.onComponentMount=p.prototype.onComponentWillMount=p.prototype.onComponentUnMount=p.prototype.onComponentWillUnMount=p.prototype.onComponentCancelUpdate=function(){},p.prototype.shouldComponentUpdate=function(){return!0},p.prototype.isReactiveHTMLComponent=!0;return{Component:p,render:function(a,b){a=t(a),w(a,b,"appendChild")},createElement:n,createFactory:function(b){if(l(b))throw TypeError("createFactory expecting first parameter as component Class, you give ".concat(a(b)));return function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return n(b,a)}},memo:h}});
