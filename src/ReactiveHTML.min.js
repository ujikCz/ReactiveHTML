/** 
 *  (c) LudvÃ­k Prokopec
 *  License: MIT 
 */
!function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"===("undefined"==typeof exports?"undefined":n(exports))&&"undefined"!=typeof module?module.exports=t(n):"function"==typeof define&&define.amd?define(function(){return t(n)}):(e=e||self).ReactiveHTML=t(n)}(void 0,function(i){"use strict";function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function a(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,n;t=r,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}var n=[];function f(e,t){void 0!==t?n.includes(t)||(n.push(t),console.warn(e)):console.warn(e)}function s(e){return window.requestAnimationFrame(e)}function d(e){return"object"===i(e)&&null!==e}function l(e){return null==e}function c(e){return"function"==typeof e}function y(e){return!(!c(e)||!e.prototype.isReactiveHTMLComponent)}function v(e){return Array.isArray(e)}var m=0,o=1;function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!e)throw TypeError("createElement(...) type must be defined, it can be String that represent DOM tagName or Class/Funciton that represent Component");var n=null,r=null;null!==t&&(void 0!==t._key&&(n=t._key,delete t._key),void 0!==t._ref&&(r=t._ref,delete t._ref)),t=t||{};for(var o=arguments.length,i=new Array(2<o?o-2:0),u=2;u<o;u++)i[u-2]=arguments[u];if(y(e))return i.length&&(t=a({children:i},t)),{type:e,props:t,_key:n};if(c(e)||!("string"==typeof e||e instanceof String))throw TypeError("createElement(...) type can be only Component or String as tag of Element");return{type:e,attrs:t,children:i,_key:n,_ref:r}}function h(e,t,n){return d(t)&&Object.assign(e.props,t),d(n)&&Object.assign(e.states,n),e}function e(e){return this.props=e,this.states={},this._internals={realDOM:null,virtual:null},this}function b(e){var t=new e.type(e.props);return t._internals.virtual=g(t.Element()),t._key=e._key,t.type=e.type,t}function g(e){if(l(e))throw Error("Element cannot return undefined or null");return e}function O(e,t,n){if(!e._internals.realDOM)throw Error("setState(...) can be called only if component is rendered, will be mounted or is mounted");if(d(t)||c(t)){if(d(t=c(t)?t.bind(e)(e.props,e.states):t)&&0!==Object.keys(t).length||f("setState(...) should be Object or Function that returns Object, if Object is empty or doesn't return nothing, update can be redundant",o),n)return h(e,null,t),e;var r=D(e,null,t);return r&&(r=(n=p(r,2))[0],n=n[1],r=p(r(e._internals.realDOM),2),e._internals.virtual=r[0],e._internals.realDOM=r[1],e.onComponentUpdate(n)),e}throw TypeError("setState(...) expecting 1 parameter as Function or Object, you give ".concat(i(t)))}function _(e,t){e.onComponentMount(e._internals.realDOM,t)}function C(e){e.onComponentRender(e._internals.realDOM)}function M(e,t){e.onComponentWillMount(e._internals.realDOM,t)}e.prototype.Element=function(){throw Error("You have to specify Element method in your Component, Element must return virtual element")},e.prototype.setState=function(e){return O(this,e,!1)},e.prototype.onComponentRender=e.prototype.onComponentWillUpdate=e.prototype.onComponentUpdate=e.prototype.onComponentWillMount=e.prototype.onComponentMount=e.prototype.onComponentCancelUpdate=e.prototype.getSnapshotBeforeUpdate=e.prototype.componentWillReceiveProps=e.prototype.onComponentWillUnMount=function(){},e.prototype.shouldComponentUpdate=function(){return!0},e.prototype.isReactiveHTMLComponent=!0;var w=[];function E(t){if(d(t))if(y(t.type))t.onComponentWillUnMount(t._internals.realDOM),t.setState=function(){t.setState=function(){};var e=t.constructor.name;if(!w.includes(e))throw w.push(e),Error("Remove all asynchronnous functions that causes setState(...) of ".concat(e," in onComponentWillUnMount, else it causes memory leak"))},E(t._internals.virtual);else for(var e=0;e<t.children.length;e++)E(t.children[e])}function D(e,t,n){if(!e.shouldComponentUpdate(t,n))return(e=h(e,t,n)).onComponentCancelUpdate(),!1;var r=e.getSnapshotBeforeUpdate()||null;(e=h(e,t,n)).onComponentWillUpdate(r);n=g(e.Element());return[k(e._internals.virtual,n),r]}function j(e){var t,n,r=document.createElement(e.type);for(t in e.attrs)t.startsWith("on")?(n=t.replace("on",""),r.addEventListener(n,e.attrs[t])):d(e.attrs[t])?Object.assign(r[t],e.attrs[t]):l(e.attrs[t])||(t in r?r[t]=e.attrs[t]:r.setAttribute(t,e.attrs[t]));if(e.children.length){for(var o=document.createDocumentFragment(),i=0,u=e.children;i<u.length;i++){var a=N(u[i]);S(a,o,"appendChild"),a&&(u[i]=v(a=a)?a.map(function(e){return e.virtualNode}):a.virtualNode)}r.appendChild(o)}return r}function S(e,t,n){for(var r=arguments.length,o=new Array(3<r?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];if(v(e)){var u=document.createDocumentFragment();return e=e.map(function(e){return S.apply(void 0,[e,u,n].concat(o))}),t.appendChild(u)}var a=y(e.virtualNode.type);return void 0!==e.realDOM&&(a&&M(e.virtualNode,t),t[n].apply(t,[e.realDOM].concat(o)),a&&_(e.virtualNode,t)),e.realDOM}function N(e){if(l(e))throw Error("virtual node cannot be null or undefined");if(v(e))return e.map(N);if(!d(e))return{realDOM:document.createTextNode(e),virtualNode:e};if(y(e.type)){var t=N((e=b(e))._internals.virtual);return e._internals={realDOM:t.realDOM,virtual:t.virtualNode},C(e),{realDOM:t.realDOM,virtualNode:e}}t=j(e);return e._ref&&(Object.assign(e._ref,resolveRef(e._ref,t)),e._ref._onresolve&&e._ref._onresolve(e._ref)),{realDOM:t,virtualNode:e}}function k(n,r){var e=d(n),t=d(r),o=e&&y(n.type),i=t&&y(r.type);return void 0===r?function(e){return E(n),s(function(){return e.remove()}),[void 0,void 0]}:o||i?function(r,o,e,t){if(e&&t)return r.type===o.type?function(e){r.setState=function(e){return O(r,e,!0)},r.componentWillReceiveProps(o.props),r.setState=function(e){return O(r,e,!1)};var t,n=D(r,o.props,null);return n&&(n=(t=p(n,2))[0],t=t[1],n=p(n(e),2),r._internals.virtual=n[0],r._internals.realDOM=n[1],r.onComponentUpdate(t)),[r,e]}:function(e){var t=b(o);E(r);var n=p(k(r._internals.virtual,t._internals.virtual)(e),2);return t._internals.virtual=n[0],t._internals.realDOM=n[1],C(t),M(t,e.parentNode),_(t,e.parentNode),[t,e]};return!e||t?function(e){var t=b(o),n=p(k(r,t._internals.virtual)(e),2);return t._internals.virtual=n[0],t._internals.realDOM=n[1],C(t),M(t,e.parentNode),_(t,e.parentNode),[t,e]}:function(e){var t=p(k(r._internals.virtual,o)(e),2);return o=t[0],e=t[1],E(r),[o,e]}}(n,r,o,i):e&&t?n.type!==r.type?function(e){var t=N(r);return s(function(){return S(t,e,"replaceWith")}),[t.virtualNode,t.realDOM]}:function(e){return n._memo?[n,e]:((d(n.attrs)||d(r.attrs))&&(t=p(function(n,r){var e,o=[];for(e in r)!function(t){t.startsWith("on")?t in n||o.push(function(e){return e.addEventListener(t.replace("on",""),r[t]),e}):d(r[t])?o.push(function(e){return Object.assign(e[t],r[t]),e}):r[t]===n[t]&&t in n||o.push(function(e){return l(r[t])?e.removeAttribute("className"===t?"class":t):t in e?e[t]=r[t]:e.setAttribute(t,r[t]),e})}(e);for(var t in n)!function(t){t in r||(t.startsWith("on")?o.push(function(e){return e.removeEventListener(t.replace("on",""),n[t]),e}):o.push(function(e){return e.removeAttribute(t),e}))}(t);return function(e){for(var t=0;t<o.length;t++)e=o[t](e);return[r,e]}}(n.attrs||{},r.attrs||{})(e),2),r.attrs=t[0],e=t[1]),0<n.children.length+r.children.length&&(t=function t(o,i,n){var u=[];var a=[];var e=function(r,e){v(o[r])?a.push(t(o[r],i[r],!0)):d(o[r])&&null!==o[r]._key?u.push(function(e){var t=i.find(function(e){return e._key===o[r]._key}),n=i.indexOf(t),t=k(o[r],t)(e),t=p(t,2);return i[n]=t[0],e=t[1],[i[n],e]}):(n&&f("Children inside array should be keyed by _key attribute/prop, if you don't key your elements, it can cause redundant rerender or bad rerender",m),u.push(function(e){var t=k(o[r],i[r])(e),t=p(t,2);return i[r]=t[0],e=t[1],[i[r],e]}))};for(var r=0,l=o.length;r<l;r++)e(r,l);function c(r,t){if(r.length>t.length)for(var e=function(n,e){v(r[n])?c(r[n],t[n]||[]):null!==r[n]._key?t.some(function(e){return e._key===r[n]._key})||a.push(function(e){var t=N(r[n]);return r[n]=t.virtualNode,o=(n===r.length-1?S(t,e,"appendChild"):S(t,e,"insertBefore",e.childNodes[n]),n),[r,e]}):(n+=t.length,a.push(function(e){var t=N(r[n]);return r[n]=t.virtualNode,S(t,e,"appendChild"),o=n,[r,e]})),o=n},o=0,n=r.length;o<n;o++)e(o,n)}c(i,o);return function(t){A(u,t.childNodes).forEach(function(e){var t=p(e,2),e=t[0],t=t[1];e(t)});for(var e=function(e){s(function(){return a[e](t)})},n=0;n<a.length;n++)e(n);return[i,t]}}(n.children,r.children)(e),t=p(t,2),r.children=t[0],e=t[1]),[r,e]);var t}:function(t,n,e,r){if(e||r)return function(e){var t=N(n);return s(function(){return S(t,e,"replaceWith")}),[t.virtualNode,t.realDOM]};return t!==n?function(e){return[e.nodeValue=n,e]}:function(e){return[t,e]}}(n,r,e,t)}function A(e,t){for(var n=[],r=0;r<Math.min(e.length,t.length);r++)n.push([e[r],t[r]]);return n}return{Component:e,render:function(t,n){s(function(){if(!n||n.nodeType!==Node.ELEMENT_NODE)throw TypeError("render(...) container must be valid Element that is already rendered on page, try to use DOMContentLoaded event on window to wait for all Elements load");var e=N(t);t=e.virtualNode,S(e,n,"appendChild")})},createElement:u,createFactory:function(o){if(y(o))throw TypeError("createFactory(...) expecting first parameter as component Class, you give ".concat(i(o)));return function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return u.apply(void 0,[o,e].concat(n))}},memo:function(e){return y(e.type)?f("Memoizing Component will not affect Component from rerender, Component has lifecycle hook shouldComponentUpdate(nextProps, nextStates), which is used to decide if Component will udpate or not"):e._memo=!0,e},ref:function(e){return{node:null,resolved:!1,_onresolve:e}}}});
